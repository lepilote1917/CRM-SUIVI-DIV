<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ðŸ”’ DIV CRM - Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0B0B0F;
      --surface:#111217;
      --border:rgba(255,255,255,.08);
      --text:rgba(255,255,255,.92);
      --accent:#4F7CFF;
    }
    *{box-sizing:border-box; margin:0; padding:0}
    body{
      font-family: Inter, -apple-system, sans-serif;
      background: radial-gradient(1200px 800px at 50% 0%, rgba(79,124,255,.18), transparent 55%), var(--bg);
      color:var(--text);
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .login-box{
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 40px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 20px 80px rgba(0,0,0,.6);
    }
    .logo{
      width:48px; height:48px; margin:0 auto 20px auto;
      background: linear-gradient(135deg, #FF5C7A, #4F7CFF);
      border-radius:16px;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; font-size:18px; letter-spacing:-1px;
      color:#fff; text-shadow: 0 1px 2px rgba(0,0,0,.3);
      box-shadow: 0 10px 30px rgba(255,92,122,.28);
    }
    h1{text-align:center; font-size:24px; margin-bottom:10px; letter-spacing:-.8px}
    p{text-align:center; color:rgba(255,255,255,.6); font-size:14px; margin-bottom:30px}
    input{
      width:100%;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--border);
      color:var(--text);
      padding:14px;
      border-radius:12px;
      font-size:16px;
      font-family:inherit;
      margin-bottom:16px;
    }
    input:focus{outline:none; border-color:var(--accent)}
    button{
      width:100%;
      background: var(--accent);
      color:#fff;
      border:none;
      padding:14px;
      border-radius:12px;
      font-size:16px;
      font-weight:700;
      cursor:pointer;
      transition:.2s;
    }
    button:hover{transform:translateY(-1px); opacity:.9}
    button:disabled{opacity:.5; cursor:not-allowed}
    .error{
      background: rgba(255,92,122,.1);
      border: 1px solid rgba(255,92,122,.3);
      color: #FF5C7A;
      padding:12px;
      border-radius:8px;
      margin-bottom:16px;
      font-size:14px;
      display:none;
    }
    .error.show{display:block}
  </style>
</head>
<body>
  <div class="login-box">
    <div class="logo">DIV</div>
    <h1>ðŸ”’ DIV CRM</h1>
    <p>Suivi Acquisition â€¢ Session blindÃ©e</p>
    <div class="error" id="error">Mot de passe incorrect</div>
    <form id="loginForm">
      <input type="password" id="password" placeholder="Code d'accÃ¨s" autofocus required>
      <button type="submit" id="submitBtn">DÃ©verrouiller</button>
    </form>
  </div>

  <script>
    const form = document.getElementById('loginForm');
    const error = document.getElementById('error');
    const btn = document.getElementById('submitBtn');
    const pwdInput = document.getElementById('password');

    form.onsubmit = async (e) => {
      e.preventDefault();
      btn.disabled = true;
      error.classList.remove('show');

      try {
        const res = await fetch('/api/auth/login', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ password: pwdInput.value })
        });

        if (res.ok) {
          window.location.href = '/';
        } else {
          error.classList.add('show');
          pwdInput.value = '';
          pwdInput.focus();
        }
      } catch (err) {
        error.textContent = 'Erreur de connexion';
        error.classList.add('show');
      } finally {
        btn.disabled = false;
      }
    };
  </script>
</body>
</html>
